04/19/2024 21:09:44 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/temp.jsonl', output_dir='./saved_models', language_type='cpp', eval_data_file='../data/temp.jsonl', test_data_file='../data/temp.jsonl', model_name_or_path='../../huggingface_models/microsoft/codebert-base/', block_size=400, do_train=True, do_eval=False, do_test=False, evaluate_during_training=True, train_batch_size=1, eval_batch_size=1, gradient_accumulation_steps=1, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, epoch=3, max_steps=-1, warmup_steps=0, logging_steps=50, save_steps=50, seed=123456, min_loss_delta=0.001, dropout_probability=0, device=device(type='cuda'), n_gpu=2, start_epoch=0, start_step=0)
04/19/2024 21:09:47 - INFO - __main__ -   ***** Running training *****
04/19/2024 21:09:47 - INFO - __main__ -     Num examples = 20
04/19/2024 21:09:47 - INFO - __main__ -     Num Epochs = 3
04/19/2024 21:09:47 - INFO - __main__ -     Batch size = 1
04/19/2024 21:09:47 - INFO - __main__ -     Total train batch size = 1
04/19/2024 21:09:47 - INFO - __main__ -     Gradient Accumulation steps = 1
04/19/2024 21:09:47 - INFO - __main__ -     Total optimization steps = 60
  0%|          | 0/20 [00:00<?, ?it/s]  0%|          | 0/20 [00:02<?, ?it/s]
tensor([[[    0, 44987, 20951,  ...,     1,     1,     1],
         [    0, 44987, 20951,  ...,     1,     1,     1],
         [    0, 44987, 20951,  ...,     1,     1,     1],
         ...,
         [    0, 47717, 38304,  ...,     1,     1,     1],
         [    0, 47157,  4027,  ...,     1,     1,     1],
         [    0, 21710, 11474,  ...,     1,     1,     1]]], device='cuda:0')
torch.Size([1, 27, 400])
tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0]], device='cuda:0')
torch.Size([1, 27])
tensor([[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
         1, 1, 1]], device='cuda:0')
torch.Size([27, 400])
['__annotations__', '__class__', '__class_getitem__', '__contains__', '__dataclass_fields__', '__dataclass_params__', '__delattr__', '__delitem__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__ior__', '__iter__', '__le__', '__len__', '__lt__', '__match_args__', '__module__', '__ne__', '__new__', '__or__', '__post_init__', '__reduce__', '__reduce_ex__', '__repr__', '__reversed__', '__ror__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'attentions', 'clear', 'copy', 'cross_attentions', 'fromkeys', 'get', 'hidden_states', 'items', 'keys', 'last_hidden_state', 'move_to_end', 'past_key_values', 'pooler_output', 'pop', 'popitem', 'setdefault', 'to_tuple', 'update', 'values']
tensor([[[ 2.8669e-01,  2.8806e-01, -7.4381e-01,  ..., -1.3934e-01,
          -7.9535e-02,  9.1566e-01],
         [-7.0862e-01, -2.9622e-03,  9.4286e-02,  ..., -2.5209e-01,
          -4.0606e-01,  3.2149e-01],
         [-1.8584e-02, -3.3982e-01,  1.1740e-01,  ..., -4.8983e-01,
          -2.7838e-01, -5.7913e-02],
         ...,
         [ 1.7762e-01,  1.7375e-01,  3.9752e-01,  ..., -4.7521e-02,
          -2.0250e-01, -1.8060e-01],
         [ 3.0328e-01, -1.8326e-01, -9.0917e-02,  ..., -1.1236e-01,
          -4.8324e-01, -2.5935e-01],
         [ 2.4130e-01, -1.4332e-01,  2.4083e-01,  ...,  6.5052e-01,
          -7.9253e-01,  4.1598e-01]],

        [[-2.9659e-02,  3.1243e-02, -6.9193e-02,  ..., -2.8865e-02,
          -5.0973e-01,  5.8601e-01],
         [-3.5216e-01, -1.3387e-01, -7.2525e-02,  ..., -3.8438e-01,
          -5.9939e-01,  5.5720e-01],
         [-1.1081e-01, -2.9571e-01,  7.9775e-02,  ..., -1.9563e-01,
          -5.5819e-01,  9.3869e-02],
         ...,
         [ 2.3445e-02,  2.0627e-01, -9.9366e-02,  ...,  2.1069e-01,
          -4.9293e-01,  2.4404e-01],
         [ 2.8653e-01, -1.6648e-01, -4.0788e-01,  ...,  2.6405e-01,
          -5.8690e-01,  1.3186e-01],
         [ 1.7991e-02,  6.2915e-02, -2.6485e-01,  ...,  3.0988e-01,
          -5.3164e-01,  3.2806e-01]],

        [[-1.2133e-01,  1.8466e-01, -6.1534e-02,  ..., -1.2036e-01,
          -3.6235e-01,  3.3620e-01],
         [ 4.5753e-02,  1.2059e-01,  1.7969e-01,  ...,  1.3090e-01,
          -7.8986e-01,  5.5095e-01],
         [ 4.6674e-02, -2.7623e-01,  2.1507e-02,  ..., -6.0200e-01,
          -2.9240e-01,  1.6407e-01],
         ...,
         [ 1.7292e-01,  3.4066e-01,  2.3006e-01,  ...,  1.9008e-01,
          -7.0789e-01,  1.5936e-01],
         [ 1.6325e-01,  2.0023e-01,  2.2578e-01,  ...,  5.3803e-02,
          -4.8266e-01, -3.5751e-02],
         [-1.5204e-01,  5.6951e-01, -1.4298e-01,  ..., -2.6757e-01,
          -3.5913e-01,  2.2232e-01]],

        ...,

        [[-1.0389e-01,  1.5959e-01,  1.6148e-02,  ..., -9.5424e-02,
          -3.9716e-01,  3.4860e-01],
         [-5.8689e-02, -5.5384e-01,  3.1626e-01,  ..., -7.0075e-01,
          -4.7485e-01,  7.1226e-01],
         [ 3.4679e-02, -2.1840e-01,  1.9218e-01,  ..., -3.1442e-01,
          -4.2613e-01,  4.4733e-01],
         ...,
         [-1.3298e-01,  1.1357e-01,  1.7063e-02,  ..., -1.8210e-01,
          -1.5637e-01,  2.5664e-01],
         [-3.8710e-02, -1.6634e-02,  1.1345e-01,  ..., -3.1356e-02,
          -5.7299e-01,  2.8969e-01],
         [-2.5710e-02, -6.0276e-02,  3.5349e-01,  ...,  1.1318e-01,
          -3.6535e-01,  2.2118e-01]],

        [[ 6.5539e-02,  7.9254e-02,  2.0542e-01,  ..., -1.8451e-02,
          -4.6795e-01,  1.3049e-01],
         [-4.4522e-01, -1.9740e-01,  7.9620e-02,  ..., -1.3412e+00,
          -5.4615e-01,  4.6555e-01],
         [-1.3317e-01, -3.0751e-01,  8.4822e-02,  ..., -4.5531e-01,
          -3.7867e-01,  9.9201e-02],
         ...,
         [-4.3884e-02, -1.6082e-03,  3.9986e-01,  ..., -4.3820e-01,
          -4.7036e-01,  3.0152e-01],
         [ 7.4144e-02,  2.2045e-01,  1.2992e-01,  ..., -1.1287e-01,
          -3.1068e-01, -4.5911e-02],
         [ 2.6971e-01,  5.4250e-02,  1.8772e-01,  ..., -9.8048e-02,
          -1.3541e-02,  4.3861e-02]],

        [[ 1.3806e-02,  7.9740e-02, -2.1504e-01,  ...,  8.9745e-02,
          -4.6603e-01,  8.0668e-02],
         [-2.0652e-01, -1.9979e-01, -1.3238e-02,  ..., -1.7901e-01,
          -5.8024e-01,  3.9632e-01],
         [ 5.0949e-02,  1.5306e-01,  1.7329e-01,  ..., -3.3697e-01,
          -6.8329e-01, -2.1993e-01],
         ...,
         [ 2.2890e-01,  4.1651e-02,  8.3070e-02,  ...,  2.2705e-01,
          -2.3575e-01,  2.4421e-01],
         [ 2.5040e-01,  6.5854e-02,  7.3520e-02,  ...,  1.2451e-01,
          -4.3729e-01,  2.3770e-01],
         [ 2.2569e-01,  4.5572e-02, -6.6317e-04,  ..., -2.8143e-02,
          -4.5371e-01,  1.4290e-01]]], device='cuda:0',
       grad_fn=<NativeLayerNormBackward0>)
torch.Size([27, 400, 768])
tensor([[ 0.3984,  0.0332, -0.2693,  ..., -0.1623, -0.1105,  0.4986],
        [ 0.6283, -0.5579, -0.5146,  ..., -0.0739,  0.1749,  0.1556],
        [ 0.3215, -0.4695, -0.5443,  ..., -0.0415, -0.0795,  0.0565],
        ...,
        [ 0.3439, -0.4824, -0.5218,  ...,  0.0455,  0.0536, -0.0525],
        [ 0.5866, -0.5213, -0.4869,  ..., -0.1646, -0.0477,  0.2454],
        [ 0.5263, -0.5760, -0.5986,  ..., -0.2156,  0.0907,  0.0863]],
       device='cuda:0', grad_fn=<TanhBackward0>)
torch.Size([27, 768])
