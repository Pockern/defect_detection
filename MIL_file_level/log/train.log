Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at ../../huggingface_models/microsoft/codebert-base/ and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
04/20/2024 23:41:51 - INFO - __main__ -   Training/evaluation parameters Namespace(train_data_file='../data/py/train.jsonl', output_dir='./saved_models', language_type='py', eval_data_file='../data/py/valid.jsonl', test_data_file='../data/py/test.jsonl', model_name_or_path='../../huggingface_models/microsoft/codebert-base/', block_size=400, do_train=True, do_eval=False, do_test=False, evaluate_during_training=True, train_batch_size=32, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=2e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, epoch=5, max_steps=-1, warmup_steps=0, logging_steps=50, save_steps=50, seed=123456, min_loss_delta=0.001, dropout_probability=0, device=device(type='cuda'), n_gpu=2, per_gpu_train_batch_size=16, per_gpu_eval_batch_size=32, start_epoch=0, start_step=0)
04/20/2024 23:42:06 - INFO - __main__ -   *** Example ***
04/20/2024 23:42:06 - INFO - __main__ -   idx: 0
04/20/2024 23:42:06 - INFO - __main__ -   file_id: CWE-400/py/bad_1916_3
04/20/2024 23:42:06 - INFO - __main__ -   label: 1
04/20/2024 23:42:06 - INFO - __main__ -   input_tokens: ['<s>', 'import', '_c', 'gi', '_import', '_logging', '_import', '_random', '_import', '_sys', '_import', '_ur', 'll', 'ib', '.', 'parse', '_from', '_io', '_import', '_By', 'tes', 'IO', '_from', '_typing', '_import', '_Call', 'able', ',', '_D', 'ict', ',', '_List', ',', '_Optional', ',', '_T', 'uple', ',', '_Union', '_import', '_att', 'r', '_import', '_tre', 'q', '_from', '_canonical', 'json', '_import', '_encode', '_', 'canon', 'ical', '_', 'json', '_from', '_prom', 'etheus', '_', 'client', '_import', '_Counter', '_from', '_signed', 'json', '.', 'sign', '_import', '_sign', '_', 'json', '_from', '_twisted', '.', 'internet', '_import', '_defer', '_from', '_twisted', '.', 'internet', '.', 'error', '_import', '_DNS', 'Look', 'up', 'Error', '_from', '_twisted', '.', 'internet', '.', 'inter', 'faces', '_import', '_I', 'Re', 'actor', 'Time', '_from', '_twisted', '.', 'internet', '.', 'task', '_import', '__', 'E', 'PS', 'IL', 'ON', ',', '_Cooper', 'ator', '_from', '_twisted', '.', 'web', '.', 'http', '_', 'headers', '_import', '_Head', 'ers', '_from', '_twisted', '.', 'web', '.', 'i', 'web', '_import', '_I', 'Body', 'Produ', 'cer', ',', '_I', 'Response', '_import', '_syn', 'apse', '.', 'met', 'rics', '_import', '_syn', 'apse', '.', 'util', '.', 'ret', 'ry', 'utils', '_from', '_syn', 'apse', '.', 'api', '.', 'errors', '_import', '_(', '_Federation', 'Den', 'ied', 'Error', ',', '_H', 'ttp', 'Response', 'Exception', ',', '_Request', 'Send', 'F', 'ailed', ',', '_)', '_from', '_syn', 'apse', '.', 'http', '_import', '_Quiet', 'er', 'File', 'Body', 'Produ', 'cer', '_from', '_syn', 'apse', '.', 'http', '.', 'client', '_import', '_(', '_Black', 'list', 'ing', 'Agent', 'Wra', 'pper', ',', '_Black', 'list', 'ing', 'Re', 'actor', 'Wra', 'pper', ',', '_encode', '_', 'query', '_', 'args', ',', '_read', 'Body', 'To', 'File', ',', '_)', '_from', '_syn', 'apse', '.', 'http', '.', 'f', 'ederation', '.', 'mat', 'rix', '_', 'f', 'ederation', '_', 'agent', '_import', '_Matrix', 'F', 'ederation', 'Agent', '_from', '_syn', 'apse', '.', 'log', 'ging', '.', 'context', '_import', '_make', '_', 'def', 'erred', '_', 'y', 'ield', 'able', '_from', '_syn', 'apse', '.', 'log', 'ging', '.', 'op', 'ent', 'r', 'acing', '_import', '_(', '_inject', '_', 'active', '_', 'span', '_', 'byte', '_', 'dict', ',', '_set', '_', 'tag', ',', '_start', '_', 'active', '_', 'span', ',', '_tags', ',', '_)', '_from', '_syn', 'apse', '.', 'types', '_import', '_J', 'son', 'D', 'ict', '_from', '_syn', 'apse', '.', 'util', '_import', '_json', '_', 'dec', 'oder', '_from', '_syn', 'apse', '.', 'util', '.', 'as', 'ync', '_', 'help', 'ers', '_import', '_timeout', '_', 'def', 'erred', '_from', '_syn', 'apse', '.', 'util', '.', 'met', 'rics', '_import', '_Measure', '_logger', '_=', '_logging', '.', 'get', 'Log', 'ger', '(', '__', 'name', '__', ')', '_outgoing', '_', 'requ', 'ests', '_', 'counter', '_=', '_Counter', '(', '_"', 'syn', 'apse', '_', 'http', '_', 'mat', 'rix', 'f', 'ederation', 'client', '_', 'requ', 'ests', '",', '_"', '",', '_["', 'method', '"]', '_)', '_incoming', '_', 'respons', 'es', '_', 'counter', '_=', '_Counter', '</s>']
04/20/2024 23:42:06 - INFO - __main__ -   input_ids: 0 41975 740 15696 6595 19980 6595 9624 6595 47427 6595 11540 890 1452 4 48778 31 46155 6595 870 12782 6454 31 29691 6595 3310 868 6 211 11726 6 9527 6 44526 6 255 45926 6 1332 6595 15095 338 6595 6110 1343 31 45615 40962 6595 46855 1215 47696 3569 1215 40962 31 12206 48208 1215 38557 6595 19271 31 1419 40962 4 13033 6595 1203 1215 40962 31 22027 4 42182 6595 22992 31 22027 4 42182 4 44223 6595 40098 15833 658 30192 31 22027 4 42182 4 8007 40289 6595 38 9064 24625 14699 31 22027 4 42182 4 45025 6595 18134 717 3888 3063 2191 6 5097 2630 31 22027 4 10534 4 8166 1215 47288 6595 3928 268 31 22027 4 10534 4 118 10534 6595 38 41024 41999 7742 6 38 47806 6595 17796 26053 4 5646 18715 6595 17796 26053 4 32843 4 4903 1506 49320 31 17796 26053 4 30602 4 48487 6595 36 6692 27267 2550 30192 6 289 48741 47806 48847 6 18593 42735 597 13355 6 4839 31 17796 26053 4 8166 6595 31015 254 9966 41024 41999 7742 31 17796 26053 4 8166 4 38557 6595 36 1378 8458 154 45443 48265 5961 6 1378 8458 154 9064 24625 48265 5961 6 46855 1215 48360 1215 48204 6 1166 41024 3972 9966 6 4839 31 17796 26053 4 8166 4 506 41447 4 9244 15072 1215 506 41447 1215 23224 6595 29830 597 41447 45443 31 17796 26053 4 12376 3923 4 46796 6595 146 1215 9232 23474 1215 219 8363 868 31 17796 26053 4 12376 3923 4 1517 1342 338 7575 6595 36 17951 1215 12228 1215 36407 1215 47692 1215 25867 6 278 1215 10058 6 386 1215 12228 1215 36407 6 19445 6 4839 31 17796 26053 4 41817 6595 344 1478 495 11726 31 17796 26053 4 32843 6595 49133 1215 11127 15362 31 17796 26053 4 32843 4 281 46707 1215 19178 268 6595 25386 1215 9232 23474 31 17796 26053 4 32843 4 5646 18715 6595 22328 37764 5457 19980 4 6460 23345 2403 1640 30529 13650 30529 43 14234 1215 42172 10092 1215 24774 5457 19271 1640 22 38972 26053 1215 8166 1215 9244 15072 506 41447 38557 1215 42172 10092 1297 22 1297 46679 45416 42248 4839 11433 1215 36515 293 1215 24774 5457 19271 2
04/20/2024 23:42:06 - INFO - __main__ -   *** Example ***
04/20/2024 23:42:06 - INFO - __main__ -   idx: 1
04/20/2024 23:42:06 - INFO - __main__ -   file_id: CWE-400/py/good_1916_3
04/20/2024 23:42:06 - INFO - __main__ -   label: 0
04/20/2024 23:42:06 - INFO - __main__ -   input_tokens: ['<s>', 'import', '_c', 'gi', '_import', '_logging', '_import', '_random', '_import', '_sys', '_import', '_ur', 'll', 'ib', '.', 'parse', '_from', '_io', '_import', '_By', 'tes', 'IO', '_from', '_typing', '_import', '_Call', 'able', ',', '_D', 'ict', ',', '_List', ',', '_Optional', ',', '_T', 'uple', ',', '_Union', '_import', '_att', 'r', '_import', '_tre', 'q', '_from', '_canonical', 'json', '_import', '_encode', '_', 'canon', 'ical', '_', 'json', '_from', '_prom', 'etheus', '_', 'client', '_import', '_Counter', '_from', '_signed', 'json', '.', 'sign', '_import', '_sign', '_', 'json', '_from', '_twisted', '.', 'internet', '_import', '_defer', '_from', '_twisted', '.', 'internet', '.', 'error', '_import', '_DNS', 'Look', 'up', 'Error', '_from', '_twisted', '.', 'internet', '.', 'inter', 'faces', '_import', '_I', 'Re', 'actor', 'Time', '_from', '_twisted', '.', 'internet', '.', 'task', '_import', '__', 'E', 'PS', 'IL', 'ON', ',', '_Cooper', 'ator', '_from', '_twisted', '.', 'web', '.', 'http', '_', 'headers', '_import', '_Head', 'ers', '_from', '_twisted', '.', 'web', '.', 'i', 'web', '_import', '_I', 'Body', 'Produ', 'cer', ',', '_I', 'Response', '_import', '_syn', 'apse', '.', 'met', 'rics', '_import', '_syn', 'apse', '.', 'util', '.', 'ret', 'ry', 'utils', '_from', '_syn', 'apse', '.', 'api', '.', 'errors', '_import', '_(', '_Codes', ',', '_Federation', 'Den', 'ied', 'Error', ',', '_H', 'ttp', 'Response', 'Exception', ',', '_Request', 'Send', 'F', 'ailed', ',', '_Syn', 'apse', 'Error', ',', '_)', '_from', '_syn', 'apse', '.', 'http', '_import', '_Quiet', 'er', 'File', 'Body', 'Produ', 'cer', '_from', '_syn', 'apse', '.', 'http', '.', 'client', '_import', '_(', '_Black', 'list', 'ing', 'Agent', 'Wra', 'pper', ',', '_Black', 'list', 'ing', 'Re', 'actor', 'Wra', 'pper', ',', '_Body', 'Ex', 'ceed', 'ed', 'Max', 'Size', ',', '_encode', '_', 'query', '_', 'args', ',', '_read', '_', 'body', '_', 'with', '_', 'max', '_', 'size', ',', '_)', '_from', '_syn', 'apse', '.', 'http', '.', 'f', 'ederation', '.', 'mat', 'rix', '_', 'f', 'ederation', '_', 'agent', '_import', '_Matrix', 'F', 'ederation', 'Agent', '_from', '_syn', 'apse', '.', 'log', 'ging', '.', 'context', '_import', '_make', '_', 'def', 'erred', '_', 'y', 'ield', 'able', '_from', '_syn', 'apse', '.', 'log', 'ging', '.', 'op', 'ent', 'r', 'acing', '_import', '_(', '_inject', '_', 'active', '_', 'span', '_', 'byte', '_', 'dict', ',', '_set', '_', 'tag', ',', '_start', '_', 'active', '_', 'span', ',', '_tags', ',', '_)', '_from', '_syn', 'apse', '.', 'types', '_import', '_J', 'son', 'D', 'ict', '_from', '_syn', 'apse', '.', 'util', '_import', '_json', '_', 'dec', 'oder', '_from', '_syn', 'apse', '.', 'util', '.', 'as', 'ync', '_', 'help', 'ers', '_import', '_timeout', '_', 'def', 'erred', '_from', '_syn', 'apse', '.', 'util', '.', 'met', 'rics', '_import', '_Measure', '_logger', '_=', '_logging', '.', 'get', 'Log', 'ger', '(', '__', 'name', '__', ')', '_outgoing', '_', 'requ', 'ests', '_', 'counter', '_=', '_Counter', '(', '_"', 'syn', 'apse', '_', 'http', '_', 'mat', 'rix', 'f', 'ederation', 'client', '</s>']
04/20/2024 23:42:06 - INFO - __main__ -   input_ids: 0 41975 740 15696 6595 19980 6595 9624 6595 47427 6595 11540 890 1452 4 48778 31 46155 6595 870 12782 6454 31 29691 6595 3310 868 6 211 11726 6 9527 6 44526 6 255 45926 6 1332 6595 15095 338 6595 6110 1343 31 45615 40962 6595 46855 1215 47696 3569 1215 40962 31 12206 48208 1215 38557 6595 19271 31 1419 40962 4 13033 6595 1203 1215 40962 31 22027 4 42182 6595 22992 31 22027 4 42182 4 44223 6595 40098 15833 658 30192 31 22027 4 42182 4 8007 40289 6595 38 9064 24625 14699 31 22027 4 42182 4 45025 6595 18134 717 3888 3063 2191 6 5097 2630 31 22027 4 10534 4 8166 1215 47288 6595 3928 268 31 22027 4 10534 4 118 10534 6595 38 41024 41999 7742 6 38 47806 6595 17796 26053 4 5646 18715 6595 17796 26053 4 32843 4 4903 1506 49320 31 17796 26053 4 30602 4 48487 6595 36 45019 6 6692 27267 2550 30192 6 289 48741 47806 48847 6 18593 42735 597 13355 6 16241 26053 30192 6 4839 31 17796 26053 4 8166 6595 31015 254 9966 41024 41999 7742 31 17796 26053 4 8166 4 38557 6595 36 1378 8458 154 45443 48265 5961 6 1378 8458 154 9064 24625 48265 5961 6 13048 9089 32326 196 19854 45698 6 46855 1215 48360 1215 48204 6 1166 1215 9773 1215 5632 1215 29459 1215 10799 6 4839 31 17796 26053 4 8166 4 506 41447 4 9244 15072 1215 506 41447 1215 23224 6595 29830 597 41447 45443 31 17796 26053 4 12376 3923 4 46796 6595 146 1215 9232 23474 1215 219 8363 868 31 17796 26053 4 12376 3923 4 1517 1342 338 7575 6595 36 17951 1215 12228 1215 36407 1215 47692 1215 25867 6 278 1215 10058 6 386 1215 12228 1215 36407 6 19445 6 4839 31 17796 26053 4 41817 6595 344 1478 495 11726 31 17796 26053 4 32843 6595 49133 1215 11127 15362 31 17796 26053 4 32843 4 281 46707 1215 19178 268 6595 25386 1215 9232 23474 31 17796 26053 4 32843 4 5646 18715 6595 22328 37764 5457 19980 4 6460 23345 2403 1640 30529 13650 30529 43 14234 1215 42172 10092 1215 24774 5457 19271 1640 22 38972 26053 1215 8166 1215 9244 15072 506 41447 38557 2
04/20/2024 23:42:08 - INFO - __main__ -   ***** Running training *****
04/20/2024 23:42:08 - INFO - __main__ -     Num examples = 806
04/20/2024 23:42:08 - INFO - __main__ -     Num Epochs = 5
04/20/2024 23:42:08 - INFO - __main__ -     Instantaneous batch size per GPU = 16
04/20/2024 23:42:08 - INFO - __main__ -     Total train batch size = 32
04/20/2024 23:42:08 - INFO - __main__ -     Gradient Accumulation steps = 1
04/20/2024 23:42:08 - INFO - __main__ -     Total optimization steps = 130
  0%|          | 0/26 [00:00<?, ?it/s]/home/u200110901/.conda/envs/codebert/lib/python3.12/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
epoch 0 step 1 loss 0.68809:   0%|          | 0/26 [00:03<?, ?it/s]epoch 0 step 1 loss 0.68809:   4%|▍         | 1/26 [00:03<01:32,  3.70s/it]epoch 0 step 2 loss 0.69127:   4%|▍         | 1/26 [00:04<01:32,  3.70s/it]epoch 0 step 2 loss 0.69127:   8%|▊         | 2/26 [00:04<00:42,  1.76s/it]epoch 0 step 3 loss 0.69143:   8%|▊         | 2/26 [00:04<00:42,  1.76s/it]epoch 0 step 3 loss 0.69143:  12%|█▏        | 3/26 [00:04<00:25,  1.11s/it]epoch 0 step 4 loss 0.69197:  12%|█▏        | 3/26 [00:04<00:25,  1.11s/it]epoch 0 step 4 loss 0.69197:  15%|█▌        | 4/26 [00:04<00:17,  1.23it/s]epoch 0 step 5 loss 0.69244:  15%|█▌        | 4/26 [00:05<00:17,  1.23it/s]epoch 0 step 5 loss 0.69244:  19%|█▉        | 5/26 [00:05<00:13,  1.56it/s]epoch 0 step 6 loss 0.69716:  19%|█▉        | 5/26 [00:05<00:13,  1.56it/s]epoch 0 step 6 loss 0.69716:  23%|██▎       | 6/26 [00:05<00:10,  1.85it/s]epoch 0 step 7 loss 0.69706:  23%|██▎       | 6/26 [00:05<00:10,  1.85it/s]epoch 0 step 7 loss 0.69706:  27%|██▋       | 7/26 [00:05<00:09,  2.11it/s]epoch 0 step 8 loss 0.69944:  27%|██▋       | 7/26 [00:06<00:09,  2.11it/s]epoch 0 step 8 loss 0.69944:  31%|███       | 8/26 [00:06<00:07,  2.31it/s]epoch 0 step 9 loss 0.69784:  31%|███       | 8/26 [00:06<00:07,  2.31it/s]epoch 0 step 9 loss 0.69784:  35%|███▍      | 9/26 [00:06<00:06,  2.47it/s]epoch 0 step 10 loss 0.69835:  35%|███▍      | 9/26 [00:06<00:06,  2.47it/s]epoch 0 step 10 loss 0.69835:  38%|███▊      | 10/26 [00:06<00:06,  2.60it/s]epoch 0 step 11 loss 0.69967:  38%|███▊      | 10/26 [00:07<00:06,  2.60it/s]epoch 0 step 11 loss 0.69967:  42%|████▏     | 11/26 [00:07<00:05,  2.69it/s]epoch 0 step 12 loss 0.69924:  42%|████▏     | 11/26 [00:07<00:05,  2.69it/s]epoch 0 step 12 loss 0.69924:  46%|████▌     | 12/26 [00:07<00:05,  2.76it/s]epoch 0 step 13 loss 0.69985:  46%|████▌     | 12/26 [00:07<00:05,  2.76it/s]epoch 0 step 13 loss 0.69985:  50%|█████     | 13/26 [00:07<00:04,  2.81it/s]epoch 0 step 14 loss 0.69975:  50%|█████     | 13/26 [00:08<00:04,  2.81it/s]epoch 0 step 14 loss 0.69975:  54%|█████▍    | 14/26 [00:08<00:04,  2.84it/s]epoch 0 step 15 loss 0.7009:  54%|█████▍    | 14/26 [00:08<00:04,  2.84it/s] epoch 0 step 15 loss 0.7009:  58%|█████▊    | 15/26 [00:08<00:03,  2.86it/s]epoch 0 step 16 loss 0.70037:  58%|█████▊    | 15/26 [00:08<00:03,  2.86it/s]epoch 0 step 16 loss 0.70037:  62%|██████▏   | 16/26 [00:08<00:03,  2.88it/s]epoch 0 step 17 loss 0.70025:  62%|██████▏   | 16/26 [00:09<00:03,  2.88it/s]epoch 0 step 17 loss 0.70025:  65%|██████▌   | 17/26 [00:09<00:03,  2.89it/s]epoch 0 step 18 loss 0.70081:  65%|██████▌   | 17/26 [00:09<00:03,  2.89it/s]epoch 0 step 18 loss 0.70081:  69%|██████▉   | 18/26 [00:09<00:02,  2.90it/s]epoch 0 step 19 loss 0.70049:  69%|██████▉   | 18/26 [00:09<00:02,  2.90it/s]epoch 0 step 19 loss 0.70049:  73%|███████▎  | 19/26 [00:09<00:02,  2.91it/s]epoch 0 step 20 loss 0.70032:  73%|███████▎  | 19/26 [00:10<00:02,  2.91it/s]epoch 0 step 20 loss 0.70032:  77%|███████▋  | 20/26 [00:10<00:02,  2.91it/s]epoch 0 step 21 loss 0.69888:  77%|███████▋  | 20/26 [00:10<00:02,  2.91it/s]epoch 0 step 21 loss 0.69888:  81%|████████  | 21/26 [00:10<00:01,  2.91it/s]epoch 0 step 22 loss 0.69923:  81%|████████  | 21/26 [00:10<00:01,  2.91it/s]epoch 0 step 22 loss 0.69923:  85%|████████▍ | 22/26 [00:10<00:01,  2.91it/s]epoch 0 step 23 loss 0.69909:  85%|████████▍ | 22/26 [00:11<00:01,  2.91it/s]epoch 0 step 23 loss 0.69909:  88%|████████▊ | 23/26 [00:11<00:01,  2.92it/s]epoch 0 step 24 loss 0.69989:  88%|████████▊ | 23/26 [00:11<00:01,  2.92it/s]epoch 0 step 24 loss 0.69989:  92%|█████████▏| 24/26 [00:11<00:00,  2.92it/s]epoch 0 step 25 loss 0.69945:  92%|█████████▏| 24/26 [00:11<00:00,  2.92it/s]epoch 0 step 25 loss 0.69945:  96%|█████████▌| 25/26 [00:11<00:00,  2.92it/s]epoch 0 step 26 loss 0.69956:  96%|█████████▌| 25/26 [00:12<00:00,  2.92it/s]epoch 0 step 26 loss 0.69956:  96%|█████████▌| 25/26 [00:12<00:00,  2.05it/s]
26
